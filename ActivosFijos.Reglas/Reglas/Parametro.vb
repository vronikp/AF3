'------------------------------------------------------------------------------
' <auto-generated>
'     Este código fue generado por una herramienta.
'     Versión del motor en tiempo de ejecución:2.0.50727.5446
'
'     Los cambios en este archivo podrían causar un comportamiento incorrecto y se perderán si
'     se vuelve a generar el código.
' </auto-generated>
'------------------------------------------------------------------------------

Option Strict Off
Option Explicit On

Imports Infoware.Datos


#Region "Parametro"
Public Class Parametro
    
    Const _Procedimiento As String = "proc_Parametro"
    
    Private mParametro As Parametro = Nothing
    
    Public Sub New(ByVal _OperadorDatos As OperadorDatos, ByVal _EsNuevo As Boolean)
        MyBase.New
        OperadorDatos = _OperadorDatos
        EsNuevo = _EsNuevo
    End Sub
    
    Public Sub New(ByVal _OperadorDatos As OperadorDatos, ByVal _Parame_Codigo As Integer)
        Me.New(_OperadorDatos, false)
        Parame_Codigo = _Parame_Codigo
        If Me.Recargar Then
        Else
            Throw New System.Exception("No se puede cargar objeto Parametro")
        End If
    End Sub
    
    'Parametro
    Public Overridable Property Parametro() As Parametro
        Get
            Return Me.mParametro
        End Get
        Set
            Me.mParametro = value
        End Set
    End Property
    
    Public Overridable Sub MapearDataRowaObjeto(ByVal Fila As DataRow)
        Parame_Codigo = CType(Fila("Parame_Codigo"),Integer)
        Parame_Descripcion = CType(Fila("Parame_Descripcion"),String)
        Parame_Modificable = CType(Fila("Parame_Modificable"),Boolean)
        Parame_Padre = CType(Fila("Parame_Padre"),Integer)
        Parame_esImagen = CType(Fila("Parame_esImagen"),Boolean)
        Parame_LeyendaDatoStr1 = CType(Fila("Parame_LeyendaDatoStr1"),String)
        Parame_LeyendaDatoStr2 = CType(Fila("Parame_LeyendaDatoStr2"),String)
        Parame_LeyendaDatoStr3 = CType(Fila("Parame_LeyendaDatoStr3"),String)
        Parame_LeyendaDatoInt1 = CType(Fila("Parame_LeyendaDatoInt1"),String)
        Parame_CtaCtble1 = CType(Fila("Parame_CtaCtble1"),String)
        Parame_CtaCtble2 = CType(Fila("Parame_CtaCtble2"),String)
        Parame_LeyendaDatoImg1 = CType(Fila("Parame_LeyendaDatoImg1"),String)
        Parame_LeyendaDatoDec1 = CType(Fila("Parame_LeyendaDatoDec1"),String)
        Parame_LeyendaLeyenda = CType(Fila("Parame_LeyendaLeyenda"),String)
        Parame_LeyendaDatoBit1 = CType(Fila("Parame_LeyendaDatoBit1"),String)
        mParametro = Nothing
    End Sub
    
    Public Overridable Function Recargar() As Boolean
        Dim Result As System.Data.DataTable = New System.Data.DataTable
        Dim bReturn As Boolean = true
        OperadorDatos.AgregarParametro("@accion", "C")
        OperadorDatos.AgregarParametro("@Parame_Codigo", Parame_Codigo)
        OperadorDatos.Procedimiento = _Procedimiento
        bReturn = OperadorDatos.Ejecutar(Result)
        OperadorDatos.LimpiarParametros
        Try 
      Me.MapearDataRowaObjeto(Result.Rows(0))
            EsNuevo = false
            EsModificado = false
        Catch ex As System.Exception
            bReturn = false
        End Try
        Return bReturn
    End Function
    
    Public Overridable Function Guardar() As Boolean
        Dim Result As Integer = 0
        Dim bReturn As Boolean = true
        Dim sAccion As String = "M"
        If esNuevo Then
            sAccion = "I"
        End If
        OperadorDatos.AgregarParametro("@accion", sAccion)
        OperadorDatos.AgregarParametro("@Parame_Codigo", Parame_Codigo)
        OperadorDatos.AgregarParametro("@Parame_Descripcion", Parame_Descripcion)
        OperadorDatos.AgregarParametro("@Parame_Modificable", Parame_Modificable)
        OperadorDatos.AgregarParametro("@Parame_Padre", Parame_Padre)
        OperadorDatos.AgregarParametro("@Parame_esImagen", Parame_esImagen)
        OperadorDatos.AgregarParametro("@Parame_LeyendaDatoStr1", Parame_LeyendaDatoStr1)
        OperadorDatos.AgregarParametro("@Parame_LeyendaDatoStr2", Parame_LeyendaDatoStr2)
        OperadorDatos.AgregarParametro("@Parame_LeyendaDatoStr3", Parame_LeyendaDatoStr3)
        OperadorDatos.AgregarParametro("@Parame_LeyendaDatoInt1", Parame_LeyendaDatoInt1)
        OperadorDatos.AgregarParametro("@Parame_CtaCtble1", Parame_CtaCtble1)
        OperadorDatos.AgregarParametro("@Parame_CtaCtble2", Parame_CtaCtble2)
        OperadorDatos.AgregarParametro("@Parame_LeyendaDatoImg1", Parame_LeyendaDatoImg1)
        OperadorDatos.AgregarParametro("@Parame_LeyendaDatoDec1", Parame_LeyendaDatoDec1)
        OperadorDatos.AgregarParametro("@Parame_LeyendaLeyenda", Parame_LeyendaLeyenda)
        OperadorDatos.AgregarParametro("@Parame_LeyendaDatoBit1", Parame_LeyendaDatoBit1)
        OperadorDatos.Procedimiento = _Procedimiento
        bReturn = OperadorDatos.Ejecutar(Result)
        OperadorDatos.LimpiarParametros
        If bReturn Then
            If OperadorDatos.EstaenTransaccion Then
            Else
                Me.AceptarCambios
            End If
        End If
        Return bReturn
    End Function
    
    Public Overridable Sub AceptarCambios()
        EsNuevo = false
        EsModificado = false
    End Sub
    
    Public Overridable Function Eliminar() As Boolean
        Dim bReturn As Boolean = true
        OperadorDatos.AgregarParametro("@accion", "E")
        OperadorDatos.AgregarParametro("@Parame_Codigo", Parame_Codigo)
        OperadorDatos.Procedimiento = _Procedimiento
        bReturn = OperadorDatos.Ejecutar
        OperadorDatos.LimpiarParametros
        Return bReturn
    End Function
End Class
#End Region

#Region "ParametroList"
Public Class ParametroList
    Inherits System.ComponentModel.BindingList(Of )
End Class
#End Region
